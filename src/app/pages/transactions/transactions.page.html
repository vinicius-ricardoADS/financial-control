<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Lançamentos</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar
      [(ngModel)]="searchTerm"
      (ionInput)="onSearchChange($event)"
      placeholder="Buscar lançamentos..."
      animated="true"
    ></ion-searchbar>
  </ion-toolbar>
  <ion-toolbar>
    <ion-segment [(ngModel)]="filterType" (ionChange)="onFilterChange($event)">
      <ion-segment-button value="all">
        <ion-label>Todas</ion-label>
      </ion-segment-button>
      <ion-segment-button [value]="ReleaseTypes.INCOME">
        <ion-label>Receitas</ion-label>
      </ion-segment-button>
      <ion-segment-button [value]="ReleaseTypes.EXPENSE">
        <ion-label>Despesas</ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="transactions-container">
    <ion-list *ngIf="filteredTransactions.length > 0">
      <ion-item *ngFor="let transaction of filteredTransactions" lines="full">
        <div class="transaction-icon" slot="start">
          <span class="category-icon">{{ transaction.category_icon }}</span>
        </div>
        <ion-label>
          <h2>{{ transaction.description }}</h2>
          <p>{{ transaction.category_name }} • {{ formatDate(transaction.date) }}</p>
          <p class="transaction-meta">
            <span class="recurrence-badge">{{ getRecurrenceLabel(transaction.recurrence_type) }}</span>
            <span
              class="status-badge"
              [class.paid]="transaction.payment_status === 'pago'"
              [class.pending]="transaction.payment_status !== 'pago'">
              {{ getPaymentStatusLabel(transaction.payment_status) }}
            </span>
          </p>
          <p *ngIf="transaction.notes" class="notes">{{ transaction.notes }}</p>
        </ion-label>
        <ion-label slot="end" class="amount-label">
          <h2 [class]="getTransactionClass(transaction.release_type)">
            {{ transaction.release_type === ReleaseTypes.INCOME ? '+' : '-' }}
            {{ formatCurrency(transaction.value) }}
          </h2>
          <p *ngIf="transaction.payment_method" class="payment-method">
            {{ transaction.payment_method }}
          </p>
        </ion-label>
      </ion-item>
    </ion-list>

    <!-- Estado vazio -->
    <div class="empty-state" *ngIf="filteredTransactions.length === 0">
      <ion-icon name="search" size="large"></ion-icon>
      <p>Nenhum lançamento encontrado</p>
      <p class="empty-subtitle">Nenhum lançamento para este mês</p>
    </div>
  </div>
</ion-content>
